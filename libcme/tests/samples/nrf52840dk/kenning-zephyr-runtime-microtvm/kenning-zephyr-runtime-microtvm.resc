logFile $ORIGIN/kenning-zephyr-runtime-microtvm-renode.log True

using sysbus
$name?="nrf52840dk_nrf52840"
mach create $name

machine LoadPlatformDescription $ORIGIN/kenning-zephyr-runtime-microtvm.repl

showAnalyzer uart0

uart0 RecordToAsciinema $ORIGIN/kenning-zephyr-runtime-microtvm-asciinema

macro reset
"""
    sysbus LoadELF @https://zephyr-dashboard.renode.io/zephyr/cce7e9a706ca848f73e4ef2c435668e358b73305/nrf52840dk_nrf52840/kenning-zephyr-runtime-microtvm/kenning-zephyr-runtime-microtvm.elf
    cpu0 VectorTableOffset `sysbus GetSymbolAddress "_vector_table"`
    cpu0 EnableProfilerCollapsedStack $ORIGIN/kenning-zephyr-runtime-microtvm-profile true
"""

runMacro $reset