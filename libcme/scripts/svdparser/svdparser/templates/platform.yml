# {{ svd['name'] }} platform description
#
# auto-generated from SVD

# device information
name: {{ svd['name'] }}

cpu:
  {% for k, v in svd['cpu'].items() -%}
  {% if not k.startswith('#') -%}
  {{ k }}: {{ v }}
  {% endif -%}
  {% endfor %}

mem:
  # flash and ram regions not generally included in svd peripherals
  # and must be manually specified

mmio:
  {% for group_name, peripheral in svd['#peripheral_groups'].items() -%}
  {% for instance_name, derived in sorted(peripheral['#derives'].items()) %}
  {{ derived['name'].lower() }}:
    description: {{ " ".join(str(derived['description']).split()) }}
    perms: 0b011
    base: {{ hex(int(derived['baseAddress'], 0)) }}
    blocksize: {{ hex(int(peripheral['addressBlock']['size'], 0)) }}
    registers:
      {% for register in peripheral['registers'] -%}
      {{ register['name'].replace('[%s]', '').lower() }}:
        address: {{ hex(int(derived['baseAddress'], 0) + int(register['addressOffset'], 0)) }}
        {% if 'dim' in register -%}
        dim: {{ hex(int(register['dim'], 0)) }}
        size: {{ hex(int(register['dimIncrement'], 0)) }}
        {%- else -%}
        size: 0x4
        {%- endif %}
      {% endfor -%}
  {% endfor %}
  {%- endfor -%}
